# Open Redirect Vulnerability

*Open redirect* is a security flaw in an app that can redirect the user to **any** page.

For example, an app could have the following url where after the user gets logged in, they would be redirected to whatever the redirect query says:

```
jeff.com/login?redirect=/
```

This can be convenient as it returns the user to where they left off, but this could also be a security issue, and that is the `redirect` query can be changed into anything, for example, an url to a malicious website:

```
jeff.com/login?redirect=hacker.com/
```

## Phishing

An example where this vulnerability could be used is phishing. 

Say you have a link that tells you it downloads Google Chrome:
```
https://www.google.com/search?btnI&q=//attacker.com
```
You won't click it because it just looks sus.

But what if you get a link like this?
```
https://www.google.com/search?btnI&q=//%61%74%74%61%63%6B%65%72%2E%63%6F%6D
```

In face, it's just `attacker.com` percent-encoded, but it's not obvious, because to see the real URL, you'll have to decode it, and apparently no one does that every time.

Let's say you clicked on that link, what happens is that Google(ignore the fact that Google now asks you to confirm if you want to continue to be redirected) would redirect. `attacker.com` can download a malicious executable to your computer and then redirect you back to Google's thank you page(the page displayed after you download the official Google Chrome).

## Prevention
One way to prevent this vulnerability from harming users is to validate the redirect url parameter, this might be
 - Checking if the endpoint is from the same host
 - Checking if it's from a trusted endpoint.
Now this becomes a `restricted redirect`.
